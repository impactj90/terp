# Employee-related schemas
Employee:
  type: object
  required:
    - id
    - tenant_id
    - personnel_number
    - first_name
    - last_name
    - entry_date
    - is_active
  properties:
    id:
      type: string
      format: uuid
    tenant_id:
      type: string
      format: uuid
    personnel_number:
      type: string
      example: "E001"
    first_name:
      type: string
      example: "John"
    last_name:
      type: string
      example: "Doe"
    email:
      type: string
      format: email
      x-nullable: true
    phone:
      type: string
      x-nullable: true
    entry_date:
      type: string
      format: date
      example: "2024-01-15"
    exit_date:
      type: string
      format: date
      x-nullable: true
    department_id:
      type: string
      format: uuid
      x-nullable: true
    cost_center_id:
      type: string
      format: uuid
      x-nullable: true
    employment_type_id:
      type: string
      format: uuid
      x-nullable: true
    tariff_id:
      type: string
      format: uuid
      x-nullable: true
    weekly_hours:
      type: number
      format: decimal
      example: 40.00
    vacation_days_per_year:
      type: number
      format: decimal
      example: 30.00
    is_active:
      type: boolean
      example: true
    # Extended personnel master data fields (ZMI-TICKET-004)
    exit_reason:
      type: string
      x-nullable: true
    notes:
      type: string
      x-nullable: true
    address_street:
      type: string
      x-nullable: true
    address_zip:
      type: string
      x-nullable: true
    address_city:
      type: string
      x-nullable: true
    address_country:
      type: string
      x-nullable: true
    birth_date:
      type: string
      format: date
      x-nullable: true
    gender:
      type: string
      enum:
        - male
        - female
        - diverse
        - not_specified
      x-nullable: true
    nationality:
      type: string
      x-nullable: true
    religion:
      type: string
      x-nullable: true
    marital_status:
      type: string
      enum:
        - single
        - married
        - divorced
        - widowed
        - registered_partnership
        - not_specified
      x-nullable: true
    birth_place:
      type: string
      x-nullable: true
    birth_country:
      type: string
      x-nullable: true
    room_number:
      type: string
      x-nullable: true
    photo_url:
      type: string
      x-nullable: true
    # Group FKs
    employee_group_id:
      type: string
      format: uuid
      x-nullable: true
    workflow_group_id:
      type: string
      format: uuid
      x-nullable: true
    activity_group_id:
      type: string
      format: uuid
      x-nullable: true
    # Order-related FKs (ZMI Auftrag)
    default_order_id:
      type: string
      format: uuid
      x-nullable: true
    default_activity_id:
      type: string
      format: uuid
      x-nullable: true
    # Tariff-related override fields (ZMI section 14.2)
    part_time_percent:
      type: number
      format: decimal
      x-nullable: true
    disability_flag:
      type: boolean
    daily_target_hours:
      type: number
      format: decimal
      x-nullable: true
    weekly_target_hours:
      type: number
      format: decimal
      x-nullable: true
    monthly_target_hours:
      type: number
      format: decimal
      x-nullable: true
    annual_target_hours:
      type: number
      format: decimal
      x-nullable: true
    work_days_per_week:
      type: number
      format: decimal
      x-nullable: true
    calculation_start_date:
      type: string
      format: date
      x-nullable: true
    pin:
      type: string
      description: Employee PIN (included in detail view only)
    created_at:
      type: string
      format: date-time
    updated_at:
      type: string
      format: date-time
    # Expanded relations
    department:
      allOf:
        - $ref: './departments.yaml#/Department'
      x-nullable: true
    cost_center:
      allOf:
        - $ref: './cost-centers.yaml#/CostCenter'
      x-nullable: true
    employment_type:
      allOf:
        - $ref: './employment-types.yaml#/EmploymentType'
      x-nullable: true
    tariff:
      allOf:
        - $ref: './tariffs.yaml#/TariffSummary'
      x-nullable: true
    employee_group:
      allOf:
        - $ref: './groups.yaml#/EmployeeGroup'
      x-nullable: true
    workflow_group:
      allOf:
        - $ref: './groups.yaml#/WorkflowGroup'
      x-nullable: true
    activity_group:
      allOf:
        - $ref: './groups.yaml#/ActivityGroup'
      x-nullable: true
    contacts:
      type: array
      items:
        $ref: '#/EmployeeContact'
    cards:
      type: array
      items:
        $ref: '#/EmployeeCard'

EmployeeSummary:
  type: object
  required:
    - id
    - personnel_number
    - first_name
    - last_name
  properties:
    id:
      type: string
      format: uuid
    personnel_number:
      type: string
    first_name:
      type: string
    last_name:
      type: string
    department_id:
      type: string
      format: uuid
      x-nullable: true
    tariff_id:
      type: string
      format: uuid
      x-nullable: true
    is_active:
      type: boolean

EmployeeContact:
  type: object
  required:
    - id
    - employee_id
    - contact_type
    - value
  properties:
    id:
      type: string
      format: uuid
    employee_id:
      type: string
      format: uuid
    contact_type:
      type: string
      enum:
        - email
        - phone
        - mobile
        - emergency
      example: "email"
      description: "Deprecated: Use contact_kind_id instead"
    contact_kind_id:
      type: string
      format: uuid
      x-nullable: true
      description: "Reference to configurable contact kind. Replaces contact_type."
    value:
      type: string
      example: "john.doe@example.com"
    label:
      type: string
      x-nullable: true
      example: "Work"
    is_primary:
      type: boolean
      example: false
    created_at:
      type: string
      format: date-time
    updated_at:
      type: string
      format: date-time

EmployeeCard:
  type: object
  required:
    - id
    - tenant_id
    - employee_id
    - card_number
    - valid_from
  properties:
    id:
      type: string
      format: uuid
    tenant_id:
      type: string
      format: uuid
    employee_id:
      type: string
      format: uuid
    card_number:
      type: string
      example: "CARD001"
    card_type:
      type: string
      enum:
        - rfid
        - barcode
        - pin
      default: "rfid"
    valid_from:
      type: string
      format: date
    valid_to:
      type: string
      format: date
      x-nullable: true
    is_active:
      type: boolean
      example: true
    deactivated_at:
      type: string
      format: date-time
      x-nullable: true
    deactivation_reason:
      type: string
      x-nullable: true
    created_at:
      type: string
      format: date-time
    updated_at:
      type: string
      format: date-time

CreateEmployeeRequest:
  type: object
  required:
    - personnel_number
    - first_name
    - last_name
    - entry_date
  properties:
    personnel_number:
      type: string
      minLength: 1
      maxLength: 50
    pin:
      type: string
      maxLength: 20
      description: Optional PIN. If not provided, auto-assigned as next available integer.
    first_name:
      type: string
      minLength: 1
      maxLength: 100
    last_name:
      type: string
      minLength: 1
      maxLength: 100
    email:
      type: string
      format: email
    phone:
      type: string
    entry_date:
      type: string
      format: date
    exit_date:
      type: string
      format: date
    department_id:
      type: string
      format: uuid
    cost_center_id:
      type: string
      format: uuid
    employment_type_id:
      type: string
      format: uuid
    tariff_id:
      type: string
      format: uuid
      x-nullable: true
    weekly_hours:
      type: number
      format: decimal
    vacation_days_per_year:
      type: number
      format: decimal
    # Extended fields
    exit_reason:
      type: string
    notes:
      type: string
    address_street:
      type: string
    address_zip:
      type: string
    address_city:
      type: string
    address_country:
      type: string
    birth_date:
      type: string
      format: date
    gender:
      type: string
      enum:
        - male
        - female
        - diverse
        - not_specified
    nationality:
      type: string
    religion:
      type: string
    marital_status:
      type: string
      enum:
        - single
        - married
        - divorced
        - widowed
        - registered_partnership
        - not_specified
    birth_place:
      type: string
    birth_country:
      type: string
    room_number:
      type: string
    photo_url:
      type: string
    employee_group_id:
      type: string
      format: uuid
    workflow_group_id:
      type: string
      format: uuid
    activity_group_id:
      type: string
      format: uuid
    default_order_id:
      type: string
      format: uuid
    default_activity_id:
      type: string
      format: uuid
    part_time_percent:
      type: number
      format: decimal
    disability_flag:
      type: boolean
    daily_target_hours:
      type: number
      format: decimal
    weekly_target_hours:
      type: number
      format: decimal
    monthly_target_hours:
      type: number
      format: decimal
    annual_target_hours:
      type: number
      format: decimal
    work_days_per_week:
      type: number
      format: decimal

UpdateEmployeeRequest:
  type: object
  properties:
    first_name:
      type: string
      minLength: 1
      maxLength: 100
    last_name:
      type: string
      minLength: 1
      maxLength: 100
    email:
      type: string
      format: email
    phone:
      type: string
    exit_date:
      type: string
      format: date
    department_id:
      type: string
      format: uuid
    cost_center_id:
      type: string
      format: uuid
    employment_type_id:
      type: string
      format: uuid
    tariff_id:
      type: string
      format: uuid
      x-nullable: true
    weekly_hours:
      type: number
      format: decimal
    vacation_days_per_year:
      type: number
      format: decimal
    # Extended fields
    exit_reason:
      type: string
    notes:
      type: string
    address_street:
      type: string
    address_zip:
      type: string
    address_city:
      type: string
    address_country:
      type: string
    birth_date:
      type: string
      format: date
    gender:
      type: string
      enum:
        - male
        - female
        - diverse
        - not_specified
    nationality:
      type: string
    religion:
      type: string
    marital_status:
      type: string
      enum:
        - single
        - married
        - divorced
        - widowed
        - registered_partnership
        - not_specified
    birth_place:
      type: string
    birth_country:
      type: string
    room_number:
      type: string
    photo_url:
      type: string
    employee_group_id:
      type: string
      format: uuid
      x-nullable: true
    workflow_group_id:
      type: string
      format: uuid
      x-nullable: true
    activity_group_id:
      type: string
      format: uuid
      x-nullable: true
    default_order_id:
      type: string
      format: uuid
      x-nullable: true
    default_activity_id:
      type: string
      format: uuid
      x-nullable: true
    part_time_percent:
      type: number
      format: decimal
    disability_flag:
      type: boolean
    daily_target_hours:
      type: number
      format: decimal
    weekly_target_hours:
      type: number
      format: decimal
    monthly_target_hours:
      type: number
      format: decimal
    annual_target_hours:
      type: number
      format: decimal
    work_days_per_week:
      type: number
      format: decimal

CreateEmployeeContactRequest:
  type: object
  required:
    - contact_type
    - value
  properties:
    contact_type:
      type: string
      enum:
        - email
        - phone
        - mobile
        - emergency
      description: "Deprecated: Use contact_kind_id instead"
    contact_kind_id:
      type: string
      format: uuid
      description: "Reference to configurable contact kind. Replaces contact_type."
    value:
      type: string
      minLength: 1
      maxLength: 255
    label:
      type: string
      maxLength: 100
    is_primary:
      type: boolean
      default: false

CreateEmployeeCardRequest:
  type: object
  required:
    - card_number
    - valid_from
  properties:
    card_number:
      type: string
      minLength: 1
      maxLength: 100
    card_type:
      type: string
      enum:
        - rfid
        - barcode
        - pin
      default: "rfid"
    valid_from:
      type: string
      format: date
    valid_to:
      type: string
      format: date

EmployeeList:
  type: object
  required:
    - data
    - total
    - page
    - limit
  properties:
    data:
      type: array
      items:
        $ref: '#/Employee'
    total:
      type: integer
      example: 150
    page:
      type: integer
      example: 1
    limit:
      type: integer

BulkTariffAssignmentFilter:
  type: object
  properties:
    q:
      type: string
    department_id:
      type: string
      format: uuid
    is_active:
      type: boolean

BulkTariffAssignmentRequest:
  type: object
  properties:
    employee_ids:
      type: array
      items:
        type: string
        format: uuid
    filter:
      $ref: '#/BulkTariffAssignmentFilter'
    tariff_id:
      type: string
      format: uuid
      x-nullable: true

BulkTariffAssignmentResponse:
  type: object
  required:
    - updated
    - skipped
  properties:
    updated:
      type: integer
    skipped:
      type: integer
      example: 20
