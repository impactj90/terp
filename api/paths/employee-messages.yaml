# Employee message endpoints (ZMI-TICKET-026)

/employee-messages:
  get:
    tags:
      - Employee Messages
    summary: List employee messages
    operationId: listEmployeeMessages
    parameters:
      - name: status
        in: query
        type: string
        enum:
          - pending
          - sent
          - failed
        description: Filter by recipient status (returns messages that have at least one recipient with this status)
      - name: limit
        in: query
        type: integer
        default: 20
        minimum: 1
        maximum: 100
      - name: offset
        in: query
        type: integer
        minimum: 0
        default: 0
    responses:
      200:
        description: List of employee messages
        schema:
          $ref: '../schemas/employee-messages.yaml#/EmployeeMessageList'
      401:
        $ref: '../responses/errors.yaml#/Unauthorized'
      403:
        $ref: '../responses/errors.yaml#/Forbidden'
  post:
    tags:
      - Employee Messages
    summary: Create a new employee message
    operationId: createEmployeeMessage
    parameters:
      - name: body
        in: body
        required: true
        schema:
          $ref: '../schemas/employee-messages.yaml#/CreateEmployeeMessageRequest'
    responses:
      201:
        description: Created employee message
        schema:
          $ref: '../schemas/employee-messages.yaml#/EmployeeMessage'
      400:
        $ref: '../responses/errors.yaml#/BadRequest'
      401:
        $ref: '../responses/errors.yaml#/Unauthorized'
      403:
        $ref: '../responses/errors.yaml#/Forbidden'

/employee-messages/{id}:
  get:
    tags:
      - Employee Messages
    summary: Get an employee message by ID
    operationId: getEmployeeMessage
    parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uuid
    responses:
      200:
        description: Employee message
        schema:
          $ref: '../schemas/employee-messages.yaml#/EmployeeMessage'
      401:
        $ref: '../responses/errors.yaml#/Unauthorized'
      403:
        $ref: '../responses/errors.yaml#/Forbidden'
      404:
        $ref: '../responses/errors.yaml#/NotFound'

/employee-messages/{id}/send:
  post:
    tags:
      - Employee Messages
    summary: Send an employee message (deliver to all pending recipients)
    operationId: sendEmployeeMessage
    parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uuid
    responses:
      200:
        description: Send result
        schema:
          $ref: '../schemas/employee-messages.yaml#/SendEmployeeMessageResponse'
      401:
        $ref: '../responses/errors.yaml#/Unauthorized'
      403:
        $ref: '../responses/errors.yaml#/Forbidden'
      404:
        $ref: '../responses/errors.yaml#/NotFound'

/employees/{id}/messages:
  get:
    tags:
      - Employee Messages
    summary: List messages for a specific employee
    operationId: listEmployeeMessagesForEmployee
    parameters:
      - name: id
        in: path
        required: true
        type: string
        format: uuid
        description: Employee ID
      - name: limit
        in: query
        type: integer
        default: 20
        minimum: 1
        maximum: 100
      - name: offset
        in: query
        type: integer
        minimum: 0
        default: 0
    responses:
      200:
        description: List of messages for the employee
        schema:
          $ref: '../schemas/employee-messages.yaml#/EmployeeMessageList'
      401:
        $ref: '../responses/errors.yaml#/Unauthorized'
      403:
        $ref: '../responses/errors.yaml#/Forbidden'
